<div>
    <h1>Macros</h1>

    <ul>
        <li class="slide-step-1">A grande expectativa para o futuro da programação assíncrona em Rust é a
        funcionalidade de <code>async/await</code></li>
        <li class="slide-step-2">Um conjunto de mudanças na linguagem
            <ul>
                <li class="slide-step-3">Geradores</li>
                <li class="slide-step-4">Representação de dados imóveis</li>
                <li class="slide-step-5">Macros procedurais</li>
            </ul>
        </li>
        <li class="slide-step-6">Resultará nas macros <code>async</code> e <code>await!</code>, que possibilitam escrever código mais
        simples</li>
    </ul>

<pre><code><span class="slide-step-7">pub fn enviar_dado(dado: Dado) -&gt; impl Future&lt;Item = (), Error = Erro&gt; {</span>
    <span class="slide-step-8">TcpStream::connect(ENDERECO_SERVIDOR)</span>
        <span class="slide-step-9">.map_err(Erro::from)<span>
        <span class="slide-step-10">.and_then(|tcp_stream| {</span>
            <span class="slide-step-11">let fluxo  = tcp_stream.framed(Codificacao);</span>
            <span class="slide-step-12">fluxo.send(dado)</span>
                <span class="slide-step-13">.map_err(Erro::from)</span>
                <span class="slide-step-14">.and_then(|fluxo| {</span>
                    <span class="slide-step-15">io::shutdown(fluxo)</span>
                        <span class="slide-step-16">.map_err(Erro::from)</span>
                <span class="slide-step-14">})</span>
            
        <span class="slide-step-10">})</span>
<span class="slide-step-7">}</span>
</code></pre>

<pre><code><span class="slide-step-17">#[async]
pub fn enviar_dado(dado: Dado) -&gt; Result&lt;(), Erro&gt; {</span>
    <span class="slide-step-18">let tcp_stream = await!(TcpStream::connect(ENDERECO_SERVIDOR))?;</span>
    <span class="slide-step-19">let fluxo = tcp_stream.framed(Codificacao);</span>

    <span class="slide-step-20">let fluxo = await!(fluxo.send(dado))?;</span>
    <span class="slide-step-21">await!(io::shutdown(fluxo))?;</span>

    <span class="slide-step-22">Ok(())</span>
<span class="slide-step-17">}</span>
</code></pre>
</div>
