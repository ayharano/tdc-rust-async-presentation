<div>
    <h1>Macros</h1>

    <ul>
        <li data-slide-steps="1-">A grande expectativa para o futuro da programação assíncrona em Rust é a
        funcionalidade de <code>async/await</code></li>
        <li data-slide-steps="2-">Um conjunto de mudanças na linguagem
            <ul>
                <li data-slide-steps="3-">Geradores</li>
                <li data-slide-steps="4-">Representação de dados imóveis</li>
                <li data-slide-steps="5-">Macros procedurais</li>
            </ul>
        </li>
        <li data-slide-steps="6-">Resultará nas macros <code>async</code> e <code>await!</code>, que possibilitam escrever código mais
        simples</li>
    </ul>

<pre><code><span data-slide-steps="7-">pub fn enviar_dado(dado: Dado) -&gt; impl Future&lt;Item = (), Error = Erro&gt; {</span>
    <span data-slide-steps="8-">TcpStream::connect(ENDERECO_SERVIDOR)</span>
        <span data-slide-steps="9-">.map_err(Erro::from)<span>
        <span data-slide-steps="10-">.and_then(|tcp_stream| {</span>
            <span data-slide-steps="11-">let fluxo  = tcp_stream.framed(Codificacao);</span>
            <span data-slide-steps="12-">fluxo.send(dado)</span>
                <span data-slide-steps="13-">.map_err(Erro::from)</span>
                <span data-slide-steps="14-">.and_then(|fluxo| {</span>
                    <span data-slide-steps="15-">io::shutdown(fluxo)</span>
                        <span data-slide-steps="16-">.map_err(Erro::from)</span>
                <span data-slide-steps="14-">})</span>
            
        <span data-slide-steps="10-">})</span>
<span data-slide-steps="7-">}</span>
</span></span></code></pre>

<pre><code><span data-slide-steps="17-">#[async]
pub fn enviar_dado(dado: Dado) -&gt; Result&lt;(), Erro&gt; {</span>
    <span data-slide-steps="18-">let tcp_stream = await!(TcpStream::connect(ENDERECO_SERVIDOR))?;</span>
    <span data-slide-steps="19-">let fluxo = tcp_stream.framed(Codificacao);</span>

    <span data-slide-steps="20-">let fluxo = await!(fluxo.send(dado))?;</span>
    <span data-slide-steps="21-">await!(io::shutdown(fluxo))?;</span>

    <span data-slide-steps="22-">Ok(())</span>
<span data-slide-steps="17-">}</span>
</code></pre>
</div>